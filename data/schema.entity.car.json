{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.com/schemas/schema.entity.car.json",
  "title": "Car Entity Schema",
  "description": "JSON schema for Car entity in the event-based processing system",
  "type": "object",
  "properties": {
    "entity": {
      "$ref": "schema.entity.header.json"
    },
    "id": {
      "type": "string",
      "description": "Unique identifier for the car"
    },
    "vin": {
      "type": "string",
      "pattern": "^[A-HJ-NPR-Z0-9]{17}$",
      "description": "Vehicle Identification Number (17-character alphanumeric)"
    },
    "make": {
      "type": "string",
      "description": "Car manufacturer"
    },
    "model": {
      "type": "string",
      "description": "Car model"
    },
    "year": {
      "type": "integer",
      "minimum": 1900,
      "maximum": 2030,
      "description": "Model year of the car"
    },
    "color": {
      "type": "string",
      "description": "Color of the car"
    },
    "mileage": {
      "type": "integer",
      "minimum": 0,
      "maximum": 999999,
      "description": "Current mileage of the car"
    },
    "lastServiceDate": {
      "type": "string",
      "format": "date-time",
      "description": "Date of the last service performed"
    },
    "totalBalance": {
      "type": "number",
      "minimum": 0,
      "multipleOf": 0.01,
      "description": "Total outstanding balance across all loans"
    },
    "lastLoanPaymentDate": {
      "type": "string",
      "format": "date-time",
      "description": "Date of the last loan payment"
    },
    "owner": {
      "type": "string",
      "description": "Name of the car owner"
    },
    "createdAt": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp when the car record was created"
    },
    "updatedAt": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp when the car record was last updated"
    },
    "serviceRecords": {
      "type": "array",
      "items": {
        "$ref": "schema.entity.service-record.json"
      },
      "description": "Array of service records for this car"
    },
    "loans": {
      "type": "array",
      "items": {
        "$ref": "schema.entity.loan.json"
      },
      "description": "Array of loans associated with this car"
    }
  },
  "required": ["entity", "id", "vin", "make", "model", "year", "color", "mileage", "lastServiceDate", "totalBalance", "lastLoanPaymentDate", "owner", "createdAt", "updatedAt"],
  "additionalProperties": false
}
